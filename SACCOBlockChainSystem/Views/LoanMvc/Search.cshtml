@{
    ViewData["Title"] = "Search Loans";
}

<div class="card">
    <div class="card-header bg-primary text-white">
        <h4 class="mb-0"><i class="bi bi-search"></i> Search Loans</h4>
    </div>
    <div class="card-body">
        <form asp-action="SearchResults" method="get" id="searchForm">
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="memberNo" class="form-label">Member Number</label>
                        <input type="text" class="form-control" id="memberNo" name="memberNo"
                               placeholder="Enter member number" />
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="loanNo" class="form-label">Loan Number</label>
                        <input type="text" class="form-control" id="loanNo" name="loanNo"
                               placeholder="Enter loan number" />
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="loanCode" class="form-label">Loan Type</label>
                        <select class="form-select" id="loanCode" name="loanCode">
                            <option value="">All Loan Types</option>
                            <option value="EDU">Education Loan</option>
                            <option value="AGRI">Agricultural Loan</option>
                            <option value="BUS">Business Loan</option>
                            <option value="EMG">Emergency Loan</option>
                            <option value="DEV">Development Loan</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" id="status" name="status">
                            <option value="">All Statuses</option>
                            <option value="1">Pending</option>
                            <option value="2">Guarantors</option>
                            <option value="3">Appraisal</option>
                            <option value="4">Endorsement</option>
                            <option value="5">Approved</option>
                            <option value="6">Disbursed</option>
                            <option value="7">Rejected</option>
                            <option value="8">Closed</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="fromDate" class="form-label">From Date</label>
                        <input type="date" class="form-control" id="fromDate" name="fromDate" />
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="toDate" class="form-label">To Date</label>
                        <input type="date" class="form-control" id="toDate" name="toDate" />
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-between">
                <button type="reset" class="btn btn-outline-secondary">
                    <i class="bi bi-x-circle"></i> Clear
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-search"></i> Search Loans
                </button>
            </div>
        </form>

        <!-- Quick Search Links -->
        <div class="mt-4">
            <h5><i class="bi bi-lightning"></i> Quick Search</h5>
            <div class="row">
                <div class="col-md-3">
                    <a href="@Url.Action("SearchResults", new { status = 1 })" class="btn btn-outline-warning w-100 mb-2">
                        <i class="bi bi-clock"></i> Pending Loans
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="@Url.Action("SearchResults", new { status = 5 })" class="btn btn-outline-success w-100 mb-2">
                        <i class="bi bi-check-circle"></i> Approved Loans
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="@Url.Action("SearchResults", new { status = 6 })" class="btn btn-outline-primary w-100 mb-2">
                        <i class="bi bi-cash-coin"></i> Disbursed Loans
                    </a>
                </div>
                <div class="col-md-3">
                    <a href="@Url.Action("SearchResults", new { status = 8 })" class="btn btn-outline-secondary w-100 mb-2">
                        <i class="bi bi-archive"></i> Closed Loans
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Set default date range (last 30 days)
            const today = new Date();
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(today.getDate() - 30);

            $('#fromDate').val(thirtyDaysAgo.toISOString().split('T')[0]);
            $('#toDate').val(today.toISOString().split('T')[0]);

            // Form validation
            $('#searchForm').on('submit', function(e) {
                const fromDate = $('#fromDate').val();
                const toDate = $('#toDate').val();

                if (fromDate && toDate && new Date(fromDate) > new Date(toDate)) {
                    e.preventDefault();
                    alert('From date cannot be after To date.');
                    return false;
                }
            });
        });
    </script>
}